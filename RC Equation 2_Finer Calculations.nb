(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     14424,        374]
NotebookOptionsPosition[     13425,        350]
NotebookOutlinePosition[     13837,        366]
CellTagsIndexPosition[     13794,        363]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"LaunchKernels", "[", "]"}]], "Input",
 CellLabel->"",ExpressionUUID->"47fe9d4e-0a37-455c-b70e-0fb0ff0cd376"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Diff", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Beta]", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xzero", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sigma", "=", "0.01"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hx", "=", "0.001"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ht", "=", "0.01"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"length", " ", "=", " ", 
   RowBox[{"Floor", "[", 
    RowBox[{"2", "/", "hx"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"time", " ", "=", 
   RowBox[{"Floor", "[", 
    RowBox[{"3", "/", "ht"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xi", "=", " ", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"#", "-", 
         RowBox[{"length", "/", "2"}], " ", "-", "1"}], ")"}], "*", "hx"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"length", "+", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ti", "=", " ", 
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#", "-", "1"}], ")"}], "*", "ht"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"time", "+", "1"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProbM", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"length", "+", "1"}], ",", " ", 
       RowBox[{"time", "+", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"St", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", "time", "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8604677679669886`*^9, 3.8604678085849147`*^9}, {
   3.860467933188477*^9, 3.8604679382444134`*^9}, {3.8606534321676526`*^9, 
   3.8606534554346914`*^9}, 3.860653574418828*^9, {3.860653611917875*^9, 
   3.8606536785808277`*^9}, {3.860653719452813*^9, 3.8606537480099373`*^9}, 
   3.860653948714329*^9, {3.8606540697449913`*^9, 3.8606540719884768`*^9}, {
   3.8606542058433123`*^9, 3.8606542325690928`*^9}, 3.860654316889598*^9, {
   3.860654393599083*^9, 3.860654427956547*^9}, {3.860654665198611*^9, 
   3.860654672538967*^9}, {3.860654920650361*^9, 3.8606549238298407`*^9}, {
   3.8606577384949875`*^9, 3.860657741910842*^9}, {3.8606578110286837`*^9, 
   3.8606578156128464`*^9}, {3.860657856160528*^9, 3.860657857226717*^9}, {
   3.8606579460155053`*^9, 3.8606579530911827`*^9}, {3.8606581458248577`*^9, 
   3.860658150443297*^9}, {3.860667314861457*^9, 3.860667338570342*^9}, {
   3.860667513470359*^9, 3.860667515421546*^9}, {3.861181310955021*^9, 
   3.8611813188318386`*^9}, {3.861181721922116*^9, 3.861181729147683*^9}, 
   3.8611820645131598`*^9, {3.8611821996967983`*^9, 3.861182209769494*^9}, {
   3.8611823112351465`*^9, 3.861182317354415*^9}, {3.8611824245950346`*^9, 
   3.861182429720125*^9}, 3.861182599551553*^9, 3.861182704387438*^9, 
   3.8611839569849463`*^9, {3.8611847380611954`*^9, 3.861184745831811*^9}, {
   3.8611848621333017`*^9, 3.861184866354604*^9}, 3.8611849422739935`*^9, {
   3.861185532760741*^9, 3.8611855354368315`*^9}},
 CellLabel->
  "In[279]:=",ExpressionUUID->"db51d32f-c7b6-4d1e-89ea-ade4c66e51f3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BetaValues", "=", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0.25", ",", "0.5", ",", "0.75", ",", "1.", ",", "1.25", ",", 
     "1.5", ",", "1.75", ",", "2.", ",", "2.25", ",", "2.5", ",", "2.75", ",",
      "3.", ",", "3.25", ",", "3.5", ",", "3.75", ",", "4.", ",", "4.5", ",", 
     "5.", ",", "5.5", ",", "6.", ",", "6.5", ",", "7.", ",", "7.5", ",", 
     "8.", ",", "8.5", ",", "9."}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AlphaValues", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", ".1", ",", ".25", ",", "0.5", ",", "1"}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{3.86065523896397*^9},
 CellLabel->
  "In[303]:=",ExpressionUUID->"3702fcfe-d304-46c2-accd-86a7cd6661b7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0.25`", ",", "0.5`", ",", "0.75`", ",", "1.`", ",", "1.25`", ",",
    "1.5`", ",", "1.75`", ",", "2.`", ",", "2.25`", ",", "2.5`", ",", "2.75`",
    ",", "3.`", ",", "3.25`", ",", "3.5`", ",", "3.75`", ",", "4.`", ",", 
   "4.5`", ",", "5.`", ",", "5.5`", ",", "6.`", ",", "6.5`", ",", "7.`", ",", 
   "7.5`", ",", "8.`", ",", "8.5`", ",", "9.`"}], "}"}]], "Input",
 NumberMarks->False,
 CellLabel->
  "In[305]:=",ExpressionUUID->"37b0a732-9456-4aa9-92d0-bb8c46e71659"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0.25`", ",", "0.5`", ",", "0.75`", ",", "1.`", ",", "1.25`", ",",
    "1.5`", ",", "1.75`", ",", "2.`", ",", "2.25`", ",", "2.5`", ",", "2.75`",
    ",", "3.`", ",", "3.25`", ",", "3.5`", ",", "3.75`", ",", "4.`", ",", 
   "4.5`", ",", "5.`", ",", "5.5`", ",", "6.`", ",", "6.5`", ",", "7.`", ",", 
   "7.5`", ",", "8.`", ",", "8.5`", ",", "9.`"}], "}"}]], "Output",
 CellChangeTimes->{3.8611862074254713`*^9},
 CellLabel->
  "Out[305]=",ExpressionUUID->"597e0172-8106-4d7f-946f-701bf82beaef"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sol", "=", 
    RowBox[{"NDSolve", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"P", "[", 
            RowBox[{"x", ",", "t"}], "]"}], ",", "t"}], "]"}], "==", 
         RowBox[{"Diff", "*", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"\[Alpha]", "*", 
                RowBox[{"x", "^", "2"}]}]}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"P", "[", 
                  RowBox[{"x", ",", "t"}], "]"}], ",", "x"}], "]"}], "+", 
               RowBox[{"\[Beta]", "*", 
                RowBox[{"(", 
                 RowBox[{"x", "+", 
                  RowBox[{"\[Theta]", "*", 
                   RowBox[{"x", "^", "3"}]}]}], ")"}], "*", 
                RowBox[{"P", "[", 
                 RowBox[{"x", ",", "t"}], "]"}]}]}], ")"}]}], 
            "\[IndentingNewLine]", ",", "x"}], "]"}]}]}], " ", ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"P", "[", 
          RowBox[{
           RowBox[{"-", "2"}], ",", "t"}], "]"}], "==", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"P", "[", 
          RowBox[{"2", ",", "t"}], "]"}], "==", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"P", "[", 
          RowBox[{"x", ",", "0"}], "]"}], "==", 
         RowBox[{
          FractionBox["1", 
           RowBox[{
            SqrtBox["\[Pi]"], "*", "sigma"}]], 
          RowBox[{"Exp", "[", 
           FractionBox[
            RowBox[{"-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"x", "-", "xzero"}], ")"}], "^", "2"}]}], 
            RowBox[{"sigma", "^", "2"}]], "]"}]}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", "P", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", "10"}], "}"}], ",", 
      RowBox[{"AccuracyGoal", "\[Rule]", "10"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Prob", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"P", "[", 
      RowBox[{"x", ",", "t"}], "]"}], "/.", "\[VeryThinSpace]", "sol"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"j", "=", "1"}], ",", 
     RowBox[{"j", "<", 
      RowBox[{"length", "+", "1"}]}], ",", 
     RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"s", "=", "1"}], ",", 
       RowBox[{"s", "<", 
        RowBox[{"time", "+", "1"}]}], ",", 
       RowBox[{"s", "++"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"ProbM", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", "s"}], "]"}], "]"}], "=", 
         RowBox[{"Norm", "[", 
          RowBox[{"Prob", "[", 
           RowBox[{
            RowBox[{"xi", "[", 
             RowBox[{"[", "j", "]"}], "]"}], ",", 
            RowBox[{"ti", "[", 
             RowBox[{"[", "s", "]"}], "]"}]}], "]"}], "]"}]}], ";"}]}], " ", 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{
     "\"\<C:\\\\Users\\\\Ritam\\\\Documents\\\\Wolfram \
Mathematica\\\\Electron Transfer\\\\PT_Theta_\>\"", "<>", 
      RowBox[{"ToString", "[", "\[Theta]", "]"}], "<>", 
      "\"\<_SolvationPhase_Alpha_\>\"", "<>", 
      RowBox[{"ToString", "[", "\[Alpha]", "]"}], "<>", "\"\<_Beta_\>\"", "<>", 
      RowBox[{"ToString", "[", "\[Beta]", "]"}], "<>", "\"\<_x\>\"", "<>", 
      RowBox[{"ToString", "[", "xzero", "]"}], "<>", "\"\<.mat\>\""}], ",", 
     "ProbM"}], "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"s", "=", "1"}], ",", 
     RowBox[{"s", "<", 
      RowBox[{"time", "+", "1"}]}], ",", 
     RowBox[{"s", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"St", "[", 
        RowBox[{"[", "s", "]"}], "]"}], "=", 
       RowBox[{"hx", "*", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"xi", "[", 
            RowBox[{"[", "j", "]"}], "]"}], 
           RowBox[{"ProbM", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "s"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"length", "+", "1"}]}], "}"}]}], "]"}]}]}], ";"}]}], " ", 
    "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{
     "\"\<C:\\\\Users\\\\Ritam\\\\Documents\\\\Wolfram \
Mathematica\\\\Electron Transfer\\\\ST_Theta_\>\"", "<>", 
      RowBox[{"ToString", "[", "\[Theta]", "]"}], "<>", 
      "\"\<_SolvationPhase_Alpha_\>\"", "<>", 
      RowBox[{"ToString", "[", "\[Alpha]", "]"}], "<>", "\"\<_Beta_\>\"", "<>", 
      RowBox[{"ToString", "[", "\[Beta]", "]"}], "<>", "\"\<_x\>\"", "<>", 
      RowBox[{"ToString", "[", "xzero", "]"}], "<>", "\"\<.csv\>\""}], ",", 
     "St"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8481462347375636`*^9, 3.848146311008374*^9}, {
   3.8481463571885834`*^9, 3.8481463601142373`*^9}, {3.8481465891867905`*^9, 
   3.8481465991110125`*^9}, {3.84814674714893*^9, 3.8481467932438064`*^9}, {
   3.8481470534463797`*^9, 3.8481470536124167`*^9}, {3.8482622534846945`*^9, 
   3.848262256089503*^9}, {3.848262290898694*^9, 3.8482622942410626`*^9}, {
   3.8482624058691974`*^9, 3.8482624670400314`*^9}, {3.8606673485655217`*^9, 
   3.860667361011469*^9}, {3.861181253599017*^9, 3.8611812984005804`*^9}, {
   3.8611815225019073`*^9, 3.8611815298076086`*^9}, 3.8611819102610674`*^9, {
   3.861182437480334*^9, 3.861182459823701*^9}, {3.861183966040039*^9, 
   3.861183993575677*^9}, {3.8611846217928066`*^9, 3.861184630473047*^9}, {
   3.861185791359522*^9, 3.8611857914877295`*^9}, {3.86118621652686*^9, 
   3.8611862292776937`*^9}},ExpressionUUID->"3bc967cb-345a-4bf2-adf5-\
392ce152a42b"],

Cell[BoxData[
 TemplateBox[{
  "NDSolve", "mxsst", 
   "\"Using maximum number of grid points \\!\\(\\*RowBox[{\\\"10000\\\"}]\\) \
allowed by the MaxPoints or MinStepSize options for independent variable \
\\!\\(\\*RowBox[{\\\"x\\\"}]\\).\"", 2, 298, 18, 33177819262048834918, 
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.861184946401818*^9, 3.8611855395590115`*^9, 
  3.8611857922544327`*^9},
 CellLabel->
  "During evaluation of \
In[298]:=",ExpressionUUID->"b50b045b-9264-4da6-ade8-f6ae56223f9c"]
}, Open  ]]
},
WindowSize->{576, 582},
WindowMargins->{{Automatic, 0.6000000000001364}, {Automatic, 0}},
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (May 11, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"f2ef1191-ee5e-48c8-a6f1-9fcd4ba18770"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 132, 2, 28, "Input",ExpressionUUID->"47fe9d4e-0a37-455c-b70e-0fb0ff0cd376"],
Cell[693, 24, 3634, 89, 333, "Input",ExpressionUUID->"db51d32f-c7b6-4d1e-89ea-ade4c66e51f3"],
Cell[4330, 115, 746, 17, 86, "Input",ExpressionUUID->"3702fcfe-d304-46c2-accd-86a7cd6661b7"],
Cell[CellGroupData[{
Cell[5101, 136, 522, 10, 67, "Input",ExpressionUUID->"37b0a732-9456-4aa9-92d0-bb8c46e71659"],
Cell[5626, 148, 546, 10, 52, "Output",ExpressionUUID->"597e0172-8106-4d7f-946f-701bf82beaef"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6209, 163, 6666, 170, 862, "Input",ExpressionUUID->"3bc967cb-345a-4bf2-adf5-392ce152a42b"],
Cell[12878, 335, 531, 12, 46, "Message",ExpressionUUID->"b50b045b-9264-4da6-ade8-f6ae56223f9c"]
}, Open  ]]
}
]
*)

